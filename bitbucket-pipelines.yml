image: deepakdocker25/terraform-ansible


pipelines:
  default:
      - step:
            name: Test
            script:
              - ls -la
              - chdir EC2
              - export AWS_ACCESS_KEY_ID=$ACCESS_KEY
              - export AWS_SECRET_ACCESS_KEY=$SECRET_KEY
              - pwd
              - whoami
              - terraform init
              - terraform validate
              - terraform plan
              - ansible --version
              - echo $aws_key > aws_key.pem
              - chmod 400 aws_key.pem
              - cat aws_key.pem
              - ssh  -o StrictHostKeyChecking=no -i aws_key.pem ec2-user@13.235.50.132 "ls -la" 
              #- terraform apply --auto-approve
              #- terraform destroy --auto-approve
  
